### 一点总结

* 在处理状态相关问题的时候(例如对提现申请进行审核)，无论是审核通过还是审核失败，前提条件都必须是该条记录是未审核状态，因为有可能存在不同的人在同时审核同一条数据的情况。

* 中国有些城市没有县区一级数据，例如广东省东莞市、中山市，最好的方法是在省市区数据表中手动补上县区一级数据，和市的名称一样。（全国行政区划信息查询平台：http://202.108.98.30/map ）

* 关于投票活动：**前台用户填写的信息中可能含有emoji表情，需要做特殊处理**；在前台，图片文件可能会被缓存，为了防止这种情况，可以在图片名称后面加上版本号；前台用户的输入最好能做过滤处理和采用数据库提供的预处理功能；报名页面上传的图片前端需要裁剪，保证尺寸一致；报名成功后，可以直接跳转到详情页面，而不是跳转到列表页面；后台删除报名记录的时候需要去处理关联的数据，例如删除投票记录、删除报名记录、更新投票活动的统计信息等；后台详情页面的微信分享设置可以支持使用变量；防止刷票问题（流程上去控制:需要绑定手机号、投票需要短信验证码、投票过于频繁给用户推送刷票嫌疑通知、活动规则中进行解释权说明）；投票活动涉及到两个方面的时间（报名起止时间和投票起止时间）；关于活动奖项的设计有两种思路（使用权重值来表明当前奖项属于几等奖，例如权重值1表示一等奖、或者使用排序字段来把主动权交给用户，让其控制奖项在前台显示的顺序）。策划通过微信传播的投票活动的时候，需要准备好相关文案（例如，活动规则说明、奖项说明、奖品图片及对应说明、赞助商说明文字或图片、微信分享文案）。
 
* 按位与运算的使用：在预处理的时候，可以使用按位与。
```php
    $result = true;
    $db = new DB();
    $db->begin_transaction();
    
    $m = new Model('member');
    $m->name = 'zhangsan';
    $result &= $m->save();
    
    $order = new Model('order');
    $order->email = '840679824@qq.com';
    $result &= $order->save();
    
    if ($result) {
        $db->commit();
        echo 'success';
    } else {
        $db->rollback();
        echo 'fail';
    }
```

* 使用php给App应用做接口的时候变量最好都要赋初始值，避免没有数据的时候App端闪退崩溃。

* 保护用户上传的隐私图片(手持身份证照片、营业执照等)的几种思路：
（1）文件名称要尽可能复杂，最好使用强度高的加密算法，如sha1等。
（2）上传的文件要加上水印保护。
（3）将上传的隐私文件单独处理存放，放在用户不能直接访问的目录，而不是放在public目录下。需要访问图片的话，通过php来获取图片的内容，然后输出，类似于获取动态验证码的思路。

* 关于图片缩略、加水印相关的几个问题：
A. 我们大多情况下使用GD库来处理图像，除了GD库之外，我们也可以尝试imagick扩展库（面向对象，使用起来更方便）来处理图像。
B. 我们在使用GD库的时候可能会出现生成的图片有点模糊的情况，这个时候，可能的原因是：imagejpeg(resource $image [, string $filename [, int $quality ]])函数的第三个参数的值设置的比较小，导致生成的图片质量比较差。
C. 我们在使用GD库把两张图片合成的时候，看不到有任何变化，感觉像是没合成一样，这个时候，可能的原因是：imagecopymerge(resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h , int $pct)函数的最后一个参数的值设置的比较小，两图像将根据 $pct 来决定合并程度，其值范围从 0 到 100。当 pct = 0 时，实际上什么也没做。
D. 我们在使用QRcode()类生成一个二维码之后，然后再把logo嵌入到二维码正中间的时候有可能会碰到logo上红色的部分在合成的图片上变色了，这个时候，可能的情况是：QRcode()类生成的二维码是8位通道的，无法保存红色等色彩鲜艳的颜色。这个时候，我们可以先把得到的二维码再次处理一下就可以了。
E. 8位深（2的8次方）意味着有256种灰度或彩色组合。16位深（2的16次方）能表现65536种可能的颜色组合。16位图像相比8位图像有较好的色彩过渡，更加细腻，携带的色彩信息可以更加丰富。这是16位图像可表现的颜色数目大大多于8位图像之故。

* 数据库如果做了读写分离,那么在插入数据之后尽量避免马上去读该数据,因为数据库服务器之间的数据同步需要时间,你有可能会读取不到刚插入的数据,可以通过传递参数的方式来解决一致性的问题;对因为读写分离造成的数据不一致的问题可以用在后台跑脚本做数据订正的方式来保证数据的一致性.

* 使用php excel导出excel文件的时候,有些字段的数据可能会被转换成科学计数法显示,有可能造成数据的丢失,为了避免这种情况,我们可以做如下处理:
```php
(方法一) $username = $username . ' ';
(方法二) $username = $username . "\t";
```

* 随机生成的一串字符串如果给人去识别的话,最好不要让比较难以辨识的字符参与随机生成过程(比如大写的I和小写的l , 大写的O和0和小写的o等)

* 循环进行curl请求时可能会出现超时的情况，这个时候你可以在循环体中sleep()一下

* app与服务端交互的身份校验问题

* 大文件的断点续传问题
